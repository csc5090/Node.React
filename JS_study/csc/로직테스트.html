<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouncing Balls</title>
    <style>
        body {
            margin: 0;
            overflow: hidden; /* ìŠ¤í¬ë¡¤ë°” ì—†ì• ê¸° */
            background-color: #1a1a2e; /* ì–´ë‘ìš´ ë°°ê²½ìƒ‰ìœ¼ë¡œ í™”ë ¤í•¨ ê°•ì¡° */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #e0e0e0;
            text-align: center;
        }

        h4 {
            cursor: pointer;
            margin-top: 20px;
            font-size: 2em;
            color: #e94560;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            transition: color 0.3s;
        }
        h4:hover {
            color: #ff7f00;
        }

        #wrapper {
            width: 100vw; /* ì „ì²´ ë·°í¬íŠ¸ ë„ˆë¹„ */
            height: 100vh; /* ì „ì²´ ë·°í¬íŠ¸ ë†’ì´ */
            border: 5px solid #0f3460; /* ë” ì‹œí¬í•œ í…Œë‘ë¦¬ */
            position: relative;
            overflow: hidden; /* ê³µì´ ë°–ìœ¼ë¡œ ë‚˜ê°€ì§€ ì•Šë„ë¡ */
            background-color: #0c0a20; /* ì–´ë‘ìš´ ë‚´ë¶€ ë°°ê²½ */
            box-shadow: 0 0 20px rgba(233, 69, 96, 0.8); /* í…Œë‘ë¦¬ì— ë¹›ë‚˜ëŠ” íš¨ê³¼ */
        }

        .ball { /* #ball ëŒ€ì‹  .ball í´ë˜ìŠ¤ë¡œ ë³€ê²½í•˜ì—¬ ì—¬ëŸ¬ ê°œ ìƒì„± */
            border-radius: 50%;
            position: absolute;
            background-size: cover; 
            background-repeat: no-repeat;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.7); /* ê³µì—ë„ ë¹›ë‚˜ëŠ” íš¨ê³¼ */
            transition: background-color 0.1s ease-out; /* ë°°ê²½ìƒ‰ ì „í™˜ ë¶€ë“œëŸ½ê²Œ */
            will-change: transform; /* ì• ë‹ˆë©”ì´ì…˜ ì„±ëŠ¥ ìµœì í™” */
        }

        /* ë°°ê²½ ë²ˆì©ì„ íš¨ê³¼ */
        .flash {
            animation: backgroundFlash 0.1s ease-out;
        }
        @keyframes backgroundFlash {
            from { background-color: #0c0a20; }
            to { background-color: #ff7f00; } /* ë²ˆì©ì´ëŠ” ìƒ‰ìƒ */
        }
    </style>
</head>

<body>

    <h4 onclick="go()">ğŸš€ Super Ultra Hyper Bouncing Party! (í´ë¦­!) ğŸš€</h4>
    <div id="wrapper">
    </div>

    <script>
        const wrapper = document.querySelector("#wrapper");
        const BALL_IMAGE_URL = 'https://blog.kakaocdn.net/dna/dnyx2E/btqQ57CkVsO/AAAAAAAAAAAAAAAAAAAAAGYuqw_gWSvzJfRZcXRdQrWG2BfqCkL4qKfI8QnrdFyQ/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1764514799&allow_ip=&allow_referer=&signature=VEZPFh1MOH6Vw936ZmIXr3mduCQ%3D';

        const BORDER_THICKNESS = 5; // wrapperì˜ border ë‘ê»˜ (CSSì™€ ì¼ì¹˜)
        const UPDATE_INTERVAL = 8; // ì—…ë°ì´íŠ¸ ê°„ê²© 8ms (ë” ë¶€ë“œëŸ½ê³  ë¹ ë¥´ê²Œ)

        let balls = []; // ëª¨ë“  ê³µ ê°ì²´ë¥¼ ì €ì¥í•  ë°°ì—´
        let animationFrameId; // requestAnimationFrame ID

        // ë§ˆìš°ìŠ¤ ìœ„ì¹˜ ì €ì¥
        let mouseX = 0;
        let mouseY = 0;

        wrapper.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });

        // ê³µ ê°ì²´ ìƒì„±ì í•¨ìˆ˜
        function Ball(size, x, y, speedX, speedY) {
            this.element = document.createElement('div');
            this.element.className = 'ball';
            this.element.style.width = `${size}px`;
            this.element.style.height = `${size}px`;
            this.element.style.backgroundImage = `url(${BALL_IMAGE_URL})`;
            this.element.style.left = `${x}px`;
            this.element.style.top = `${y}px`;
            this.element.style.zIndex = Math.floor(Math.random() * 100); // ê²¹ì¹  ë•Œ z-indexë¡œ ë Œë”ë§ ìˆœì„œ ë‹¤ë¥´ê²Œ
            wrapper.appendChild(this.element);

            this.size = size;
            this.x = x;
            this.y = y;
            this.speedX = speedX;
            this.speedY = speedY;
            this.trail = []; // ê¼¬ë¦¬ íš¨ê³¼ë¥¼ ìœ„í•œ ë°°ì—´
            this.trailOpacity = 0.5;
        }

        // ê³µ ì—…ë°ì´íŠ¸ ë©”ì„œë“œ
        Ball.prototype.update = function() {
            // ë§ˆìš°ìŠ¤ ìƒí˜¸ì‘ìš© (ë°€ì–´ë‚´ê¸°)
            const DISTANCE_THRESHOLD = 100; // ë§ˆìš°ìŠ¤ì™€ ê³µ ì‚¬ì´ì˜ ë°˜ì‘ ê±°ë¦¬
            const PUSH_FORCE = 0.8; // ë°€ì–´ë‚´ëŠ” í˜

            const dx_mouse = this.x + this.size / 2 - mouseX;
            const dy_mouse = this.y + this.size / 2 - mouseY;
            const distance = Math.sqrt(dx_mouse * dx_mouse + dy_mouse * dy_mouse);

            if (distance < DISTANCE_THRESHOLD) {
                this.speedX += (dx_mouse / distance) * PUSH_FORCE;
                this.speedY += (dy_mouse / distance) * PUSH_FORCE;
            }

            this.x += this.speedX;
            this.y += this.speedY;

            // Xì¶• ê²½ê³„ í™•ì¸ ë° ë°©í–¥ ë°˜ì „
            if (this.x + this.size >= wrapper.offsetWidth - BORDER_THICKNESS || this.x <= BORDER_THICKNESS) {
                this.speedX *= -1;
                // ê²½ê³„ ë³´ì • (ê³µì´ í…Œë‘ë¦¬ì— ë°•íˆì§€ ì•Šë„ë¡)
                this.x = (this.x + this.size >= wrapper.offsetWidth - BORDER_THICKNESS) ? wrapper.offsetWidth - BORDER_THICKNESS - this.size : BORDER_THICKNESS;
                this.speedX += (Math.random() - 0.5) * 2; // íŠ•ê¸¸ ë•Œ ë¬´ì‘ìœ„ì„± ì¶”ê°€
                this.speedY += (Math.random() - 0.5) * 2; // íŠ•ê¸¸ ë•Œ ë¬´ì‘ìœ„ì„± ì¶”ê°€
                this.triggerCollisionEffect();
            }

            // Yì¶• ê²½ê³„ í™•ì¸ ë° ë°©í–¥ ë°˜ì „
            if (this.y + this.size >= wrapper.offsetHeight - BORDER_THICKNESS || this.y <= BORDER_THICKNESS) {
                this.speedY *= -1;
                // ê²½ê³„ ë³´ì •
                this.y = (this.y + this.size >= wrapper.offsetHeight - BORDER_THICKNESS) ? wrapper.offsetHeight - BORDER_THICKNESS - this.size : BORDER_THICKNESS;
                this.speedX += (Math.random() - 0.5) * 2; // íŠ•ê¸¸ ë•Œ ë¬´ì‘ìœ„ì„± ì¶”ê°€
                this.speedY += (Math.random() - 0.5) * 2; // íŠ•ê¸¸ ë•Œ ë¬´ì‘ìœ„ì„± ì¶”ê°€
                this.triggerCollisionEffect();
            }
            
            // ğŸŒŸ ê³µë¼ë¦¬ ì¶©ëŒ ì²˜ë¦¬ (ê°„ë‹¨í•œ ë²„ì „) ğŸŒŸ
            for (let i = 0; i < balls.length; i++) {
                let otherBall = balls[i];
                if (otherBall === this) continue; // ìê¸° ìì‹ ê³¼ëŠ” ë¹„êµ ì•ˆ í•¨

                const dx = (this.x + this.size / 2) - (otherBall.x + otherBall.size / 2);
                const dy = (this.y + this.size / 2) - (otherBall.y + otherBall.size / 2);
                const distance = Math.sqrt(dx * dx + dy * dy);
                const minDistance = this.size / 2 + otherBall.size / 2;

                if (distance < minDistance) {
                    // ê²¹ì³¤ì„ ê²½ìš° ê°„ë‹¨íˆ ë°©í–¥ì„ ë°˜ì „ (ë” ë³µì¡í•œ ë¬¼ë¦¬ ì¶©ëŒì€ ìƒëµ)
                    this.speedX *= -1;
                    this.speedY *= -1;
                    otherBall.speedX *= -1;
                    otherBall.speedY *= -1;

                    // ê²¹ì¹¨ ë°©ì§€ (ê°„ë‹¨í•˜ê²Œ ì„œë¡œ ë°€ì–´ë‚´ê¸°)
                    const overlap = minDistance - distance;
                    const adjustX = (dx / distance) * overlap / 2;
                    const adjustY = (dy / distance) * overlap / 2;
                    this.x += adjustX;
                    this.y += adjustY;
                    otherBall.x -= adjustX;
                    otherBall.y -= adjustY;

                    this.triggerCollisionEffect();
                    otherBall.triggerCollisionEffect();
                }
            }


            // ê¼¬ë¦¬ íš¨ê³¼ (Trail Effect)
            this.trail.push({ x: this.x + this.size / 2, y: this.y + this.size / 2, opacity: this.trailOpacity, size: this.size });
            if (this.trail.length > 20) { // ê¼¬ë¦¬ ê¸¸ì´ ì œí•œ
                this.trail.shift();
            }
            this.drawTrail();

            // ìœ„ì¹˜ ì ìš©
            this.element.style.left = `${this.x}px`;
            this.element.style.top = `${this.y}px`;
        };

        // ê¼¬ë¦¬ ê·¸ë¦¬ê¸° ë©”ì„œë“œ
        Ball.prototype.drawTrail = function() {
            // ì´ì „ ê¼¬ë¦¬ë¥¼ ëª¨ë‘ ì§€ì›ë‹ˆë‹¤ (ë§¤ í”„ë ˆì„ë§ˆë‹¤ ë‹¤ì‹œ ê·¸ë¦¬ê¸°)
            let existingTrails = this.element.parentNode.querySelectorAll(`.trail-${this.element.id}`);
            existingTrails.forEach(t => t.remove());

            this.trail.forEach((tPoint, index) => {
                const trailPart = document.createElement('div');
                trailPart.className = `trail trail-${this.element.id}`;
                trailPart.style.position = 'absolute';
                trailPart.style.borderRadius = '50%';
                trailPart.style.backgroundColor = `rgba(233, 69, 96, ${tPoint.opacity * (index / this.trail.length)})`; // ì ì°¨ íˆ¬ëª…í•´ì§€ë„ë¡
                trailPart.style.width = `${tPoint.size * (index / this.trail.length) * 0.5}px`; // ì ì°¨ ì‘ì•„ì§€ë„ë¡
                trailPart.style.height = `${tPoint.size * (index / this.trail.length) * 0.5}px`;
                trailPart.style.left = `${tPoint.x - trailPart.offsetWidth / 2}px`;
                trailPart.style.top = `${tPoint.y - trailPart.offsetHeight / 2}px`;
                trailPart.style.zIndex = this.element.style.zIndex - 1; // ê³µ ë’¤ì— ì˜¤ë„ë¡
                wrapper.appendChild(trailPart);
            });
        };

        // ì¶©ëŒ íš¨ê³¼ (ë°°ê²½ ë²ˆì©ì„)
        Ball.prototype.triggerCollisionEffect = function() {
            wrapper.classList.add('flash');
            setTimeout(() => {
                wrapper.classList.remove('flash');
            }, 100); // 0.1ì´ˆ ë™ì•ˆ ë²ˆì©ì„
        };

        // ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
        function animate() {
            balls.forEach(ball => ball.update());
            animationFrameId = requestAnimationFrame(animate);
        }

        // ê³µ ìƒì„± í•¨ìˆ˜
        function go() {
            // ì´ë¯¸ ì• ë‹ˆë©”ì´ì…˜ì´ ì‹œì‘ë˜ì—ˆìœ¼ë©´ ìƒˆë¡œìš´ ê³µë§Œ ì¶”ê°€
            if (!animationFrameId) {
                animate(); // ì²« ê³µ ìƒì„± ì‹œ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
            }

            // ë¬´ì‘ìœ„ í¬ê¸°, ìœ„ì¹˜, ì†ë„ ìƒì„±
            const size = Math.random() * (100 - 50) + 50; // 50px ~ 150px
            const initialX = Math.random() * (wrapper.offsetWidth - BORDER_THICKNESS * 2 - size) + BORDER_THICKNESS;
            const initialY = Math.random() * (wrapper.offsetHeight - BORDER_THICKNESS * 2 - size) + BORDER_THICKNESS;
            const speedX = (Math.random() - 0.5) * 30 + (Math.random() > 0.5 ? 1 : -1) * 5; // -10 ~ 10 ì‚¬ì´ì˜ ëœë¤ ì†ë„
            const speedY = (Math.random() - 0.5) * 30 + (Math.random() > 0.5 ? 1 : -1) * 5;

            // ìƒˆë¡œìš´ ê³µ ìƒì„± ë° ë°°ì—´ì— ì¶”ê°€
            const newBall = new Ball(size, initialX, initialY, speedX, speedY);
            newBall.element.id = `ball-${balls.length}`; // ê¼¬ë¦¬ íš¨ê³¼ë¥¼ ìœ„í•´ ID ë¶€ì—¬
            balls.push(newBall);
        }
    </script>

</body>
</html>